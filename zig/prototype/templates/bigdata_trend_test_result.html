{% extends "bigdata_base.html" %}
{% load staticfiles %}

{% block content %}
    <div class="panel panel-default">
        <div class="panel-body">
            <div class="page-header">
                <h1>量化<small>趋势指标回测结果</small></h1>
            </div>

            <div>股票名称:            测试股票1</div>
            <div class="col-md-3 alert alert-dismissible fade in" id="testTemplate" role="alert">
                <div class="panel panel-default">
                    <!-- Default panel contents -->
                    <div class="panel-heading">回测1</div>
                    <!-- List group -->
                    <ul class="list-group">
                        <li class="list-group-item"><span class="label label-success">买入</span><span class="buy">五日上穿十日</span></li>
                        <li class="list-group-item"><span class="label label-danger">卖出</span><span class="sell">五日下穿十日</span></li>
                    </ul>
                </div>
            </div>
            <div class="col-md-12">
                五日,十日均线
                <div id="digram_5_10" style="min-width:800px;height:400px"></div>
                表现
                <div id="gain_5_10" style="min-width:800px;height:400px"></div>
            </div>
            <div class="col-md-3 alert alert-dismissible fade in" role="alert">
                <div class="panel panel-default">
                    <!-- Default panel contents -->
                    <div class="panel-heading">回测2</div>
                    <!-- List group -->
                    <ul class="list-group">
                        <li class="list-group-item"><span class="label label-success">买入</span><span class="buy">五日上穿五十日</span></li>
                        <li class="list-group-item"><span class="label label-danger">卖出</span><span class="sell">五日下穿五十日</span></li>
                    </ul>
                </div>
            </div>

            <div class="col-md-12">
                五日,五十日均线
                <div id="digram_5_50" style="min-width:800px;height:400px"></div>
                表现
                <div id="gain_5_50" style="min-width:800px;height:400px"></div>
            </div>
            <!-- import highChart -->
            <script type="text/javascript" src="http://cdn.hcharts.cn/jquery/jquery-1.8.3.min.js"></script>
            <script type="text/javascript" src="http://cdn.hcharts.cn/highstock/highstock.js"></script>
            <script src="{% static 'js/strategyCharts.js' %}" ></script>

            <script type="text/javascript">
                Highcharts.setOptions(avgOptions);
                var avg_5_10 = {{ avg_5_10|safe }};
                var gain_5_10 = {{ gain_5_10|safe }};
                var avg_5_50 = {{ avg_5_50|safe }};
                var gain_5_50 = {{ gain_5_50|safe }};
                var line1 =[];
                var line2 =[];

                parseData(avg_5_10);
                var char_avg5_10 = createNewChart('digram_5_10', 'avg5', line1, 'avg10', line2);
                parseData(gain_5_10);
                var char_gain5_10 = createNewChart('gain_5_10', 'price', line1, 'cash', line2);
                parseData(avg_5_50);
                var char_avg5_50 = createNewChart('digram_5_50', 'avg5', line1, 'avg50', line2);
                parseData(gain_5_50);
                var char_gain5_50 = createNewChart('gain_5_50', 'price', line1, 'cash', line2);

                function parseData(dataSet){
                    line1.length = 0;
                    line2.length = 0;
                    dataSet.forEach(function(e){
                        var dateStrings = e[0].split('/');
                        var tempDate = Date.UTC(dateStrings[0], dateStrings[1], dateStrings[2]);
                        line1.push([tempDate, e[1]]);
                        line2.push([tempDate, e[2]]);
                    });
                };

                function createNewChart(renderTo, lineName1, data1, lineName2, data2){
                  return new Highcharts.StockChart({
                                   chart:{
                                       renderTo: renderTo,
                                   },
                                   series: [
                                       { name: lineName1, data: data1, },
                                       { name: lineName2, data: data2, }
                                   ]
                                });
                };

            </script>
        </div>
    </div>
{% endblock %}

